# ðŸš€ é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ðŸ“‹ æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆä¸€ï¼šç›´æŽ¥éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼ˆæŽ¨èï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨æŽ§åˆ¶ï¼Œæ— æ—¶é—´é™åˆ¶
- âœ… é€‚åˆé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼ˆæ‰«æè‚¡ç¥¨ï¼‰
- âœ… æˆæœ¬å¯æŽ§
- âœ… æ€§èƒ½ç¨³å®š

**éœ€è¦**ï¼š
- é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼ˆå·²æœ‰ âœ…ï¼‰
- åŸŸåï¼ˆå·²æœ‰ âœ…ï¼‰
- GitHubï¼ˆä»£ç æ‰˜ç®¡ï¼ŒæŽ¨èï¼‰
- Cloudflareï¼ˆCDN åŠ é€Ÿï¼Œå¯é€‰ä½†æŽ¨èï¼‰

### æ–¹æ¡ˆäºŒï¼šVercel + æœåŠ¡å™¨æ··åˆ

**ä¼˜ç‚¹**ï¼š
- âœ… å‰ç«¯å¿«é€Ÿå“åº”
- âœ… åŽå°ä»»åŠ¡åœ¨æœåŠ¡å™¨è¿è¡Œ

**ç¼ºç‚¹**ï¼š
- âŒ æž¶æž„å¤æ‚
- âŒ éœ€è¦ç»´æŠ¤ä¸¤å¥—çŽ¯å¢ƒ

**ç»“è®º**ï¼šæ—¢ç„¶æœ‰æœåŠ¡å™¨ï¼Œç›´æŽ¥å…¨éƒ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨æ›´ç®€å•ï¼

## ðŸŽ¯ æŽ¨èæž¶æž„

```
ç”¨æˆ·è®¿é—®
    â†“
Cloudflare CDNï¼ˆåŠ é€Ÿ + å®‰å…¨ï¼‰
    â†“
é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼ˆåº”ç”¨è¿è¡Œï¼‰
    â†“
GitHubï¼ˆä»£ç æ‰˜ç®¡ + è‡ªåŠ¨éƒ¨ç½²ï¼‰
```

## ðŸ“¦ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡æœåŠ¡å™¨çŽ¯å¢ƒ

#### 1. è¿žæŽ¥æœåŠ¡å™¨

```bash
# ä½¿ç”¨ SSH è¿žæŽ¥æœåŠ¡å™¨
ssh root@ä½ çš„æœåŠ¡å™¨IP
# æˆ–
ssh root@ä½ çš„åŸŸå
```

#### 2. æ›´æ–°ç³»ç»Ÿ

```bash
# CentOS/RHEL
yum update -y

# Ubuntu/Debian
apt update && apt upgrade -y
```

#### 3. å®‰è£… Python 3.9+

```bash
# CentOS/RHEL
yum install python3 python3-pip -y

# Ubuntu/Debian
apt install python3 python3-pip -y

# éªŒè¯ç‰ˆæœ¬
python3 --version
```

#### 4. å®‰è£… Nginxï¼ˆWeb æœåŠ¡å™¨ï¼‰

```bash
# CentOS/RHEL
yum install nginx -y

# Ubuntu/Debian
apt install nginx -y

# å¯åŠ¨ Nginx
systemctl start nginx
systemctl enable nginx
```

#### 5. å®‰è£… Git

```bash
# CentOS/RHEL
yum install git -y

# Ubuntu/Debian
apt install git -y
```

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åº”ç”¨

#### 1. åˆ›å»ºåº”ç”¨ç›®å½•

```bash
# åˆ›å»ºç›®å½•
mkdir -p /var/www/stock-analyzer
cd /var/www/stock-analyzer
```

#### 2. å…‹éš†ä»£ç ï¼ˆä»Ž GitHubï¼‰

```bash
# å¦‚æžœä»£ç åœ¨ GitHub
git clone https://github.com/ä½ çš„ç”¨æˆ·å/ä½ çš„ä»“åº“å.git .

# æˆ–è€…ç›´æŽ¥ä¸Šä¼ ä»£ç 
# ä½¿ç”¨ scp æˆ– FTP å·¥å…·ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
```

#### 3. å®‰è£… Python ä¾èµ–

```bash
cd /var/www/stock-analyzer
pip3 install -r requirements.txt

# å¦‚æžœä½¿ç”¨è™šæ‹ŸçŽ¯å¢ƒï¼ˆæŽ¨èï¼‰
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

#### 4. æµ‹è¯•è¿è¡Œ

```bash
# æµ‹è¯•åº”ç”¨æ˜¯å¦èƒ½æ­£å¸¸å¯åŠ¨
python3 bull_stock_web.py

# å¦‚æžœæ­£å¸¸ï¼ŒæŒ‰ Ctrl+C åœæ­¢
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½® Gunicornï¼ˆç”Ÿäº§çŽ¯å¢ƒ WSGI æœåŠ¡å™¨ï¼‰

#### 1. å®‰è£… Gunicorn

```bash
pip3 install gunicorn
# æˆ–ä½¿ç”¨è™šæ‹ŸçŽ¯å¢ƒ
source venv/bin/activate
pip install gunicorn
```

#### 2. åˆ›å»º Gunicorn é…ç½®æ–‡ä»¶

```bash
cat > /var/www/stock-analyzer/gunicorn_config.py << 'EOF'
bind = "127.0.0.1:5002"
workers = 4
worker_class = "sync"
timeout = 300
keepalive = 5
max_requests = 1000
max_requests_jitter = 50
preload_app = True
daemon = False
pidfile = "/var/www/stock-analyzer/gunicorn.pid"
accesslog = "/var/www/stock-analyzer/logs/access.log"
errorlog = "/var/www/stock-analyzer/logs/error.log"
loglevel = "info"
EOF

# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p /var/www/stock-analyzer/logs
```

#### 3. åˆ›å»º systemd æœåŠ¡

```bash
cat > /etc/systemd/system/stock-analyzer.service << 'EOF'
[Unit]
Description=Stock Analyzer Web Service
After=network.target

[Service]
User=root
Group=root
WorkingDirectory=/var/www/stock-analyzer
Environment="PATH=/var/www/stock-analyzer/venv/bin"
ExecStart=/var/www/stock-analyzer/venv/bin/gunicorn -c gunicorn_config.py bull_stock_web:app
ExecReload=/bin/kill -s HUP $MAINPID
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

# é‡æ–°åŠ è½½ systemd
systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
systemctl start stock-analyzer
systemctl enable stock-analyzer

# æ£€æŸ¥çŠ¶æ€
systemctl status stock-analyzer
```

### ç¬¬å››æ­¥ï¼šé…ç½® Nginx åå‘ä»£ç†

#### 1. åˆ›å»º Nginx é…ç½®

```bash
cat > /etc/nginx/conf.d/stock-analyzer.conf << 'EOF'
server {
    listen 80;
    server_name ä½ çš„åŸŸå.com www.ä½ çš„åŸŸå.com;

    # æ—¥å¿—
    access_log /var/log/nginx/stock-analyzer-access.log;
    error_log /var/log/nginx/stock-analyzer-error.log;

    # é™æ€æ–‡ä»¶
    location /static/ {
        alias /var/www/stock-analyzer/static/;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }

    # åå‘ä»£ç†åˆ° Gunicorn
    location / {
        proxy_pass http://127.0.0.1:5002;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # WebSocket æ”¯æŒï¼ˆå¦‚æžœéœ€è¦ï¼‰
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        
        # è¶…æ—¶è®¾ç½®ï¼ˆé•¿æ—¶é—´ä»»åŠ¡ï¼‰
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }

    # æ–‡ä»¶å¤§å°é™åˆ¶
    client_max_body_size 10M;
}
EOF
```

#### 2. æµ‹è¯• Nginx é…ç½®

```bash
nginx -t
```

#### 3. é‡å¯ Nginx

```bash
systemctl restart nginx
```

### ç¬¬äº”æ­¥ï¼šé…ç½® SSL è¯ä¹¦ï¼ˆHTTPSï¼‰

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Certbotï¼ˆLet's Encrypt å…è´¹è¯ä¹¦ï¼‰

```bash
# å®‰è£… Certbot
# CentOS/RHEL
yum install certbot python3-certbot-nginx -y

# Ubuntu/Debian
apt install certbot python3-certbot-nginx -y

# èŽ·å–è¯ä¹¦
certbot --nginx -d ä½ çš„åŸŸå.com -d www.ä½ çš„åŸŸå.com

# è‡ªåŠ¨ç»­æœŸ
certbot renew --dry-run
```

#### æ–¹å¼äºŒï¼šä½¿ç”¨é˜¿é‡Œäº‘ SSL è¯ä¹¦

1. åœ¨é˜¿é‡Œäº‘è´­ä¹°æˆ–ç”³è¯·å…è´¹ SSL è¯ä¹¦
2. ä¸‹è½½è¯ä¹¦æ–‡ä»¶
3. é…ç½®åˆ° Nginx

### ç¬¬å…­æ­¥ï¼šé…ç½®é˜²ç«å¢™

```bash
# å¼€æ”¾ HTTP å’Œ HTTPS ç«¯å£
# CentOS/RHEL (firewalld)
firewall-cmd --permanent --add-service=http
firewall-cmd --permanent --add-service=https
firewall-cmd --reload

# Ubuntu/Debian (ufw)
ufw allow 80/tcp
ufw allow 443/tcp
ufw reload
```

### ç¬¬ä¸ƒæ­¥ï¼šé…ç½®åŸŸåè§£æž

åœ¨é˜¿é‡Œäº‘ DNS è§£æžä¸­æ·»åŠ ï¼š

```
è®°å½•ç±»åž‹: A
ä¸»æœºè®°å½•: @
è®°å½•å€¼: ä½ çš„æœåŠ¡å™¨IPåœ°å€
TTL: 600

è®°å½•ç±»åž‹: A
ä¸»æœºè®°å½•: www
è®°å½•å€¼: ä½ çš„æœåŠ¡å™¨IPåœ°å€
TTL: 600
```

## ðŸŒ é…ç½® Cloudflareï¼ˆå¯é€‰ä½†æŽ¨èï¼‰

### ä¸ºä»€ä¹ˆæŽ¨è Cloudflareï¼Ÿ

1. **CDN åŠ é€Ÿ**ï¼šå…¨çƒèŠ‚ç‚¹ï¼Œè®¿é—®æ›´å¿«
2. **DDoS é˜²æŠ¤**ï¼šè‡ªåŠ¨é˜²æŠ¤æ”»å‡»
3. **å…è´¹ SSL**ï¼šè‡ªåŠ¨é…ç½® HTTPS
4. **ç¼“å­˜ä¼˜åŒ–**ï¼šå‡å°‘æœåŠ¡å™¨è´Ÿè½½

### é…ç½®æ­¥éª¤

1. **åœ¨ Cloudflare æ·»åŠ åŸŸå**
   - ç™»å½• [Cloudflare](https://dash.cloudflare.com)
   - æ·»åŠ ä½ çš„åŸŸå
   - é€‰æ‹©å…è´¹è®¡åˆ’

2. **ä¿®æ”¹ DNS æœåŠ¡å™¨**
   - åœ¨é˜¿é‡Œäº‘å°† DNS æœåŠ¡å™¨æ”¹ä¸º Cloudflare æä¾›çš„åœ°å€

3. **é…ç½® DNS è®°å½•**
   - åœ¨ Cloudflare æ·»åŠ  A è®°å½•ï¼š
     ```
     Type: A
     Name: @
     Content: ä½ çš„æœåŠ¡å™¨IP
     Proxy: ðŸŸ  Proxiedï¼ˆæ©™è‰²äº‘æœµï¼‰
     ```

4. **SSL/TLS è®¾ç½®**
   - é€‰æ‹© "Full" æ¨¡å¼
   - å¯ç”¨ "Always Use HTTPS"

## ðŸ”„ è‡ªåŠ¨éƒ¨ç½²ï¼ˆä½¿ç”¨ GitHubï¼‰

### 1. åœ¨æœåŠ¡å™¨é…ç½® Git

```bash
# é…ç½® Git
git config --global user.name "ä½ çš„åå­—"
git config --global user.email "ä½ çš„é‚®ç®±"
```

### 2. åˆ›å»ºè‡ªåŠ¨éƒ¨ç½²è„šæœ¬

```bash
cat > /var/www/stock-analyzer/deploy.sh << 'EOF'
#!/bin/bash
cd /var/www/stock-analyzer
git pull origin main
source venv/bin/activate
pip install -r requirements.txt
systemctl restart stock-analyzer
echo "éƒ¨ç½²å®Œæˆï¼"
EOF

chmod +x /var/www/stock-analyzer/deploy.sh
```

### 3. ä½¿ç”¨ GitHub Webhookï¼ˆå¯é€‰ï¼‰

å¯ä»¥é…ç½® GitHub Webhookï¼Œä»£ç æŽ¨é€åŽè‡ªåŠ¨éƒ¨ç½²ã€‚

## ðŸ“Š ç›‘æŽ§å’Œç»´æŠ¤

### æŸ¥çœ‹æ—¥å¿—

```bash
# åº”ç”¨æ—¥å¿—
tail -f /var/www/stock-analyzer/logs/error.log

# Nginx æ—¥å¿—
tail -f /var/log/nginx/stock-analyzer-access.log

# æœåŠ¡çŠ¶æ€
systemctl status stock-analyzer
```

### å¸¸ç”¨å‘½ä»¤

```bash
# é‡å¯æœåŠ¡
systemctl restart stock-analyzer

# åœæ­¢æœåŠ¡
systemctl stop stock-analyzer

# å¯åŠ¨æœåŠ¡
systemctl start stock-analyzer

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status stock-analyzer

# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -tlnp | grep 5002
```

## ðŸ”’ å®‰å…¨å»ºè®®

1. **ä¿®æ”¹ SSH ç«¯å£**ï¼ˆé¿å…é»˜è®¤ 22 ç«¯å£ï¼‰
2. **ä½¿ç”¨å¯†é’¥ç™»å½•**ï¼ˆç¦ç”¨å¯†ç ç™»å½•ï¼‰
3. **é…ç½®é˜²ç«å¢™**ï¼ˆåªå¼€æ”¾å¿…è¦ç«¯å£ï¼‰
4. **å®šæœŸæ›´æ–°ç³»ç»Ÿ**ï¼ˆ`yum update` æˆ– `apt update`ï¼‰
5. **ä½¿ç”¨å¼ºå¯†ç **
6. **é…ç½® fail2ban**ï¼ˆé˜²æ­¢æš´åŠ›ç ´è§£ï¼‰

## ðŸ’° æˆæœ¬ä¼°ç®—

- **é˜¿é‡Œäº‘æœåŠ¡å™¨**ï¼šå·²æœ‰ âœ…
- **åŸŸå**ï¼šå·²æœ‰ âœ…
- **GitHub**ï¼šå…è´¹ âœ…
- **Cloudflare**ï¼šå…è´¹ âœ…
- **SSL è¯ä¹¦**ï¼šLet's Encrypt å…è´¹ âœ…

**æ€»æˆæœ¬**ï¼š0 å…ƒï¼ˆå¦‚æžœæœåŠ¡å™¨å·²æœ‰ï¼‰

## ðŸ“ æ€»ç»“

### éœ€è¦çš„æœåŠ¡

- âœ… **é˜¿é‡Œäº‘æœåŠ¡å™¨**ï¼šè¿è¡Œåº”ç”¨ï¼ˆå¿…éœ€ï¼‰
- âœ… **GitHub**ï¼šä»£ç æ‰˜ç®¡ï¼ˆæŽ¨èï¼‰
- âœ… **Cloudflare**ï¼šCDN åŠ é€Ÿï¼ˆæŽ¨èï¼‰
- âŒ **Vercel**ï¼šä¸éœ€è¦

### ä¼˜åŠ¿

1. å®Œå…¨æŽ§åˆ¶ï¼Œæ— æ—¶é—´é™åˆ¶
2. é€‚åˆé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡
3. æˆæœ¬å¯æŽ§
4. æ€§èƒ½ç¨³å®š

---

**ä¸‹ä¸€æ­¥**ï¼šå‘Šè¯‰æˆ‘ä½ çš„æœåŠ¡å™¨ä¿¡æ¯ï¼ˆæ“ä½œç³»ç»Ÿã€IP åœ°å€ï¼‰ï¼Œæˆ‘å¯ä»¥å¸®ä½ åˆ›å»ºå…·ä½“çš„éƒ¨ç½²è„šæœ¬ï¼





