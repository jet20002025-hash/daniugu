# 🌐 阿里云域名配置指南

## 📋 配置步骤

### 第一步：在 Vercel 添加自定义域名

1. **登录 Vercel Dashboard**
   - 访问 [vercel.com/dashboard](https://vercel.com/dashboard)
   - 选择你的项目

2. **添加域名**
   - 进入项目设置 → **Settings** → **Domains**
   - 点击 **"Add Domain"**
   - 输入你的域名（例如：`stock.example.com` 或 `www.stock.example.com`）
   - 点击 **"Add"**

3. **获取 DNS 配置信息**
   - Vercel 会显示需要配置的 DNS 记录
   - 通常有两种方式：
     - **方式A（推荐）**: CNAME 记录
     - **方式B**: A 记录

### 第二步：在阿里云配置 DNS 解析

#### 方式一：使用 CNAME（推荐，支持 Cloudflare）

1. **登录阿里云控制台**
   - 访问 [阿里云控制台](https://ecs.console.aliyun.com)
   - 进入 **域名** → **域名解析**

2. **添加 CNAME 记录**
   - 点击你的域名
   - 点击 **"添加记录"**
   - 配置如下：
     ```
     记录类型: CNAME
     主机记录: @ 或 www 或 stock（根据你的需求）
     解析线路: 默认
     TTL: 600（或默认）
     记录值: cname.vercel-dns.com
     ```
   - 点击 **"确认"**

   **说明**：
   - `@` 表示根域名（如 `example.com`）
   - `www` 表示 `www.example.com`
   - `stock` 表示 `stock.example.com`

#### 方式二：使用 A 记录（直接解析）

如果 Vercel 提供了 IP 地址，可以配置 A 记录：

1. **在阿里云添加 A 记录**
   ```
   记录类型: A
   主机记录: @ 或 www
   解析线路: 默认
   TTL: 600
   记录值: Vercel提供的IP地址（如果有）
   ```

### 第三步：等待 DNS 生效

- DNS 解析通常需要 **5-30 分钟** 生效
- 可以使用以下命令检查：
  ```bash
  # 检查 CNAME 记录
  dig your-domain.com CNAME
  
  # 或使用 nslookup
  nslookup your-domain.com
  ```

### 第四步：验证域名

1. **在 Vercel 验证**
   - 回到 Vercel Dashboard
   - 在 Domains 页面，等待状态变为 **"Valid Configuration"**
   - Vercel 会自动配置 SSL 证书（Let's Encrypt）

2. **测试访问**
   - 等待几分钟后，访问你的域名
   - 应该能看到你的应用

## 🔒 SSL 证书配置

Vercel 会自动为你的域名配置 SSL 证书（HTTPS），通常需要：
- DNS 解析生效后
- 几分钟到几小时自动完成

你可以在 Vercel Dashboard → Domains 查看 SSL 状态。

## 🌍 配置 Cloudflare（可选，推荐）

如果你想使用 Cloudflare 的 CDN 加速和安全功能：

### 1. 将域名 DNS 服务器改为 Cloudflare

1. **在 Cloudflare 添加域名**
   - 登录 [Cloudflare](https://dash.cloudflare.com)
   - 点击 **"Add a Site"**
   - 输入你的域名
   - 选择免费计划

2. **获取 Cloudflare DNS 服务器地址**
   - Cloudflare 会提供两个 DNS 服务器地址，例如：
     - `xxx.ns.cloudflare.com`
     - `yyy.ns.cloudflare.com`

3. **在阿里云修改 DNS 服务器**
   - 登录阿里云控制台
   - 进入 **域名** → **域名解析**
   - 找到你的域名，点击 **"修改 DNS 服务器"**
   - 将阿里云的 DNS 服务器替换为 Cloudflare 提供的地址
   - 保存

4. **在 Cloudflare 配置 DNS 记录**
   - 回到 Cloudflare Dashboard
   - 进入 **DNS** → **Records**
   - 添加 CNAME 记录：
     ```
     Type: CNAME
     Name: @ 或 www
     Target: cname.vercel-dns.com
     Proxy status: 🟠 Proxied（橙色云朵）
     ```
   - 点击 **"Save"**

5. **SSL/TLS 设置**
   - 进入 **SSL/TLS** 设置
   - 选择 **"Full"** 模式
   - 确保 **"Always Use HTTPS"** 已启用

### 2. 等待生效

- DNS 服务器更改可能需要 **24-48 小时** 完全生效
- 但通常 **1-2 小时** 内就会开始工作

## 📝 常见配置示例

### 示例 1: 根域名 + www 子域名

**在阿里云或 Cloudflare 配置：**

```
记录1:
类型: CNAME
名称: @
值: cname.vercel-dns.com

记录2:
类型: CNAME
名称: www
值: cname.vercel-dns.com
```

**结果**：
- `example.com` → Vercel
- `www.example.com` → Vercel

### 示例 2: 子域名（如 stock.example.com）

**配置：**

```
类型: CNAME
名称: stock
值: cname.vercel-dns.com
```

**结果**：
- `stock.example.com` → Vercel

## ⚠️ 注意事项

1. **DNS 生效时间**
   - 通常 5-30 分钟
   - 最长可能需要 48 小时（DNS 服务器更改）

2. **SSL 证书**
   - Vercel 会自动配置，无需手动操作
   - 通常需要几分钟到几小时

3. **多个域名**
   - 可以在 Vercel 添加多个域名
   - 每个域名都需要单独配置 DNS

4. **Cloudflare 代理**
   - 如果使用 Cloudflare，确保代理状态是 **🟠 Proxied**
   - 这样可以通过 Cloudflare 的 CDN 加速

## 🔍 验证配置

### 检查 DNS 解析

```bash
# 检查 CNAME 记录
dig your-domain.com CNAME

# 检查 A 记录
dig your-domain.com A

# 或使用在线工具
# https://dnschecker.org
```

### 检查 SSL 证书

访问你的域名，浏览器地址栏应该显示：
- 🔒 锁图标
- `https://` 开头

## 🐛 常见问题

### 问题 1: DNS 解析不生效

**解决**：
- 等待更长时间（最长 48 小时）
- 检查 DNS 记录是否正确
- 清除本地 DNS 缓存：
  ```bash
  # macOS
  sudo dscacheutil -flushcache
  
  # Windows
  ipconfig /flushdns
  ```

### 问题 2: SSL 证书未生效

**解决**：
- 等待 Vercel 自动配置（通常几分钟到几小时）
- 检查 DNS 是否正确解析
- 在 Vercel Dashboard 查看 SSL 状态

### 问题 3: 访问显示错误

**解决**：
- 检查 Vercel 部署是否成功
- 检查域名是否正确添加到 Vercel
- 查看 Vercel 日志排查问题

## 📞 需要帮助？

如果遇到问题：
1. 查看 Vercel Dashboard 的域名状态
2. 查看阿里云 DNS 解析记录
3. 使用 DNS 检查工具验证解析
4. 查看 Vercel 和 Cloudflare 的文档

---

**下一步**：按照上述步骤配置，完成后告诉我，我可以帮你验证配置是否正确！

