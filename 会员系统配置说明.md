# ğŸ” ä¼šå‘˜ç³»ç»Ÿé…ç½®è¯´æ˜

## ğŸ“‹ åŠŸèƒ½è¯´æ˜

ç³»ç»Ÿå·²å®ç°ä¼šå‘˜æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ï¼Œ**åªæœ‰æ‹¥æœ‰é‚€è¯·ç çš„ç”¨æˆ·æ‰èƒ½æ³¨å†Œä½¿ç”¨**ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

1. **é‚€è¯·åˆ¶æ³¨å†Œ**ï¼šå¿…é¡»æä¾›æœ‰æ•ˆçš„é‚€è¯·ç æ‰èƒ½æ³¨å†Œ
2. **ç”¨æˆ·ç™»å½•**ï¼šæ³¨å†Œåå¯ä»¥ç™»å½•ä½¿ç”¨ç³»ç»Ÿ
3. **è®¿é—®æ§åˆ¶**ï¼šæ‰€æœ‰åŠŸèƒ½éœ€è¦ç™»å½•åæ‰èƒ½ä½¿ç”¨
4. **é‚€è¯·ç ç®¡ç†**ï¼šå¯ä»¥åˆ›å»ºå’Œç®¡ç†é‚€è¯·ç 

## ğŸ”§ é…ç½®æ­¥éª¤

### 1. é»˜è®¤é‚€è¯·ç 

ç³»ç»Ÿåˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸¤ä¸ªé»˜è®¤é‚€è¯·ç ï¼š

- `ADMIN2024` - ç®¡ç†å‘˜é‚€è¯·ç 
- `VIP2024` - VIP ç”¨æˆ·é‚€è¯·ç 

è¿™äº›é‚€è¯·ç å­˜å‚¨åœ¨ `invite_codes.json` æ–‡ä»¶ä¸­ã€‚

### 2. åˆ›å»ºæ–°é‚€è¯·ç 

å¯ä»¥é€šè¿‡ Python è„šæœ¬åˆ›å»ºæ–°é‚€è¯·ç ï¼š

```python
from user_auth import create_invite_code

# åˆ›å»ºå•ä¸ªä½¿ç”¨é‚€è¯·ç 
create_invite_code('NEWCODE2024', max_uses=1)

# åˆ›å»ºå¯å¤šæ¬¡ä½¿ç”¨çš„é‚€è¯·ç 
create_invite_code('MULTI2024', max_uses=10)
```

### 3. æŸ¥çœ‹é‚€è¯·ç åˆ—è¡¨

```python
from user_auth import list_invite_codes

codes = list_invite_codes()
for code, info in codes.items():
    print(f"é‚€è¯·ç : {code}")
    print(f"  å·²ä½¿ç”¨: {info.get('used', False)}")
    print(f"  ä½¿ç”¨æ¬¡æ•°: {info.get('use_count', 0)}/{info.get('max_uses', 1)}")
    print(f"  ä½¿ç”¨äºº: {info.get('used_by', 'N/A')}")
```

## ğŸ“ æ•°æ®æ–‡ä»¶

### users.json

å­˜å‚¨æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ï¼š

```json
{
  "username": {
    "username": "username",
    "email": "user@example.com",
    "password": "hashed_password",
    "created_at": "2026-01-07T10:00:00",
    "last_login": "2026-01-07T12:00:00",
    "invite_code": "ADMIN2024",
    "is_active": true,
    "is_vip": false
  }
}
```

### invite_codes.json

å­˜å‚¨æ‰€æœ‰é‚€è¯·ç ï¼š

```json
{
  "ADMIN2024": {
    "code": "ADMIN2024",
    "created_at": "2026-01-07T10:00:00",
    "used": false,
    "used_by": null,
    "used_at": null,
    "max_uses": 1,
    "use_count": 0
  }
}
```

## ğŸš€ ä½¿ç”¨æµç¨‹

### ç”¨æˆ·æ³¨å†Œæµç¨‹

1. è®¿é—® `/register` é¡µé¢
2. å¡«å†™ç”¨æˆ·åã€é‚®ç®±ã€å¯†ç 
3. **è¾“å…¥é‚€è¯·ç **ï¼ˆå¿…é¡»ï¼‰
4. ç‚¹å‡»æ³¨å†Œ
5. æ³¨å†ŒæˆåŠŸåè‡ªåŠ¨ç™»å½•

### ç”¨æˆ·ç™»å½•æµç¨‹

1. è®¿é—® `/login` é¡µé¢
2. è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
3. ç‚¹å‡»ç™»å½•
4. ç™»å½•æˆåŠŸåè·³è½¬åˆ°ä¸»é¡µ

### è®¿é—®æ§åˆ¶

- æœªç™»å½•ç”¨æˆ·è®¿é—®ä¸»é¡µä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢
- æ‰€æœ‰ API æ¥å£ï¼ˆé™¤ç™»å½•/æ³¨å†Œå¤–ï¼‰éƒ½éœ€è¦ç™»å½•
- ä½¿ç”¨ `@require_login` è£…é¥°å™¨ä¿æŠ¤éœ€è¦ç™»å½•çš„æ¥å£

## ğŸ”’ å®‰å…¨è¯´æ˜

1. **å¯†ç åŠ å¯†**ï¼šä½¿ç”¨ SHA256 åŠ å¯†å­˜å‚¨å¯†ç 
2. **Session ç®¡ç†**ï¼šä½¿ç”¨ Flask Session ç®¡ç†ç™»å½•çŠ¶æ€
3. **é‚€è¯·ç éªŒè¯**ï¼šæ³¨å†Œæ—¶éªŒè¯é‚€è¯·ç æœ‰æ•ˆæ€§
4. **é˜²é‡å¤ä½¿ç”¨**ï¼šé‚€è¯·ç å¯ä»¥è®¾ç½®ä½¿ç”¨æ¬¡æ•°é™åˆ¶

## ğŸ“ API æ¥å£

### æ³¨å†Œæ¥å£

```
POST /api/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@example.com",
  "password": "password123",
  "invite_code": "ADMIN2024"
}
```

### ç™»å½•æ¥å£

```
POST /api/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "password123"
}
```

### ç™»å‡ºæ¥å£

```
POST /api/logout
```

### æ£€æŸ¥ç™»å½•çŠ¶æ€

```
GET /api/check_login
```

## ğŸ› ï¸ ç®¡ç†å·¥å…·

### åˆ›å»ºé‚€è¯·ç è„šæœ¬

åˆ›å»º `create_invite_code.py`ï¼š

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""åˆ›å»ºé‚€è¯·ç å·¥å…·"""
from user_auth import create_invite_code
import sys

if __name__ == '__main__':
    if len(sys.argv) < 2:
        print("ç”¨æ³•: python create_invite_code.py <é‚€è¯·ç > [ä½¿ç”¨æ¬¡æ•°]")
        sys.exit(1)
    
    code = sys.argv[1].upper()
    max_uses = int(sys.argv[2]) if len(sys.argv) > 2 else 1
    
    result = create_invite_code(code, max_uses)
    print(result['message'])
```

ä½¿ç”¨ï¼š

```bash
python create_invite_code.py NEWCODE2024 1
python create_invite_code.py MULTI2024 10
```

### æŸ¥çœ‹ç”¨æˆ·ç»Ÿè®¡

```python
from user_auth import get_user_stats

stats = get_user_stats()
print(f"æ€»ç”¨æˆ·æ•°: {stats['total_users']}")
print(f"æ´»è·ƒç”¨æˆ·: {stats['active_users']}")
print(f"å¯ç”¨é‚€è¯·ç : {stats['available_codes']}")
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç”Ÿäº§ç¯å¢ƒ**ï¼šä¿®æ”¹ `app.config['SECRET_KEY']` ä¸ºéšæœºå­—ç¬¦ä¸²
2. **æ•°æ®å¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½ `users.json` å’Œ `invite_codes.json`
3. **é‚€è¯·ç ç®¡ç†**ï¼šå¦¥å–„ä¿ç®¡é‚€è¯·ç ï¼Œé¿å…æ³„éœ²
4. **å¯†ç å®‰å…¨**ï¼šå»ºè®®ç”¨æˆ·ä½¿ç”¨å¼ºå¯†ç 

## ğŸ”„ åç»­ä¼˜åŒ–å»ºè®®

1. **æ•°æ®åº“è¿ç§»**ï¼šä» JSON æ–‡ä»¶è¿ç§»åˆ°æ•°æ®åº“ï¼ˆSQLite/PostgreSQLï¼‰
2. **å¯†ç é‡ç½®**ï¼šæ·»åŠ å¿˜è®°å¯†ç åŠŸèƒ½
3. **é‚®ç®±éªŒè¯**ï¼šæ³¨å†Œæ—¶å‘é€éªŒè¯é‚®ä»¶
4. **è§’è‰²æƒé™**ï¼šå®ç°æ›´ç»†ç²’åº¦çš„æƒé™æ§åˆ¶
5. **ç™»å½•æ—¥å¿—**ï¼šè®°å½•ç™»å½•å†å²
6. **è´¦æˆ·ç®¡ç†**ï¼šç”¨æˆ·ä¿®æ”¹å¯†ç ã€é‚®ç®±ç­‰åŠŸèƒ½

---

**ç³»ç»Ÿå·²é…ç½®å®Œæˆï¼Œç°åœ¨åªæœ‰æ‹¥æœ‰é‚€è¯·ç çš„ç”¨æˆ·æ‰èƒ½æ³¨å†Œä½¿ç”¨ï¼**

