# ğŸ” Vercel æ¨¡å‹åŠ è½½é—®é¢˜æ’æŸ¥æŒ‡å—

## âŒ é—®é¢˜æè¿°

å‰ç«¯æ§åˆ¶å°æ˜¾ç¤ºï¼š
- `æ¨¡å‹æ£€æŸ¥ç»“æœ: Object` - API è¿”å›äº†æ•°æ®
- `æ¨¡å‹ä¸å­˜åœ¨ï¼Œéœ€è¦è®­ç»ƒ` - å‰ç«¯åˆ¤æ–­æ¨¡å‹ä¸å­˜åœ¨
- è‚¡ç¥¨åˆ—è¡¨ä¸º 0ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºç”¨æˆ·è¿˜æ²¡æœ‰æ·»åŠ è‚¡ç¥¨ï¼‰

ä½†æœ¬åœ°æµ‹è¯•æ˜¾ç¤ºæ¨¡å‹æ˜¯å¯ä»¥åŠ è½½çš„ï¼ˆ33 ä¸ªä¹°ç‚¹ç‰¹å¾ï¼Œ30 ä¸ªå–ç‚¹ç‰¹å¾ï¼‰ã€‚

## ğŸ” å¯èƒ½çš„åŸå› 

### 1. Vercel ç¯å¢ƒä¸­æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨

è™½ç„¶ `trained_model.json` æ–‡ä»¶åœ¨ Git ä»“åº“ä¸­ï¼Œä½†åœ¨ Vercel éƒ¨ç½²æ—¶å¯èƒ½ï¼š
- æ–‡ä»¶è·¯å¾„ä¸å¯¹
- æ–‡ä»¶æ²¡æœ‰è¢«æ­£ç¡®éƒ¨ç½²
- Vercel æ–‡ä»¶ç³»ç»Ÿæ˜¯åªè¯»çš„ï¼Œæ— æ³•è¯»å–æ–‡ä»¶

### 2. æ¨¡å‹åŠ è½½é€»è¾‘åœ¨ Vercel ç¯å¢ƒä¸­å¤±è´¥

Vercel ç¯å¢ƒä¸­çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯åªè¯»çš„ï¼Œå¯èƒ½æ— æ³•è¯»å– `trained_model.json` æ–‡ä»¶ã€‚

### 3. API è¿”å›æ ¼å¼ä¸åŒ¹é…

å‰ç«¯æœŸæœ› `result.common_features` å­˜åœ¨ä¸”ä¸ä¸ºç©ºï¼Œä½† API å¯èƒ½è¿”å›äº†ä¸åŒçš„æ ¼å¼ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šæ£€æŸ¥ Vercel éƒ¨ç½²æ—¥å¿—

1. è®¿é—® Vercel Dashboard
2. è¿›å…¥é¡¹ç›® â†’ Deployments â†’ æœ€æ–°çš„éƒ¨ç½²
3. æŸ¥çœ‹ Function Logs
4. æŸ¥æ‰¾ä»¥ä¸‹æ—¥å¿—ï¼š
   - `Vercel ç¯å¢ƒï¼šç¦ç”¨è‡ªåŠ¨åŠ è½½å’Œè®­ç»ƒä»¥é¿å…è¶…æ—¶`
   - `å°è¯•åŠ è½½å·²ä¿å­˜çš„æ¨¡å‹...`
   - `âœ… æ¨¡å‹åŠ è½½æˆåŠŸ` æˆ– `âš ï¸ æœªæ‰¾åˆ°å·²ä¿å­˜çš„æ¨¡å‹ï¼Œéœ€è¦é‡æ–°è®­ç»ƒ`
   - `[get_trained_features] trained æ˜¯å¦ä¸º None: ...`
   - `[get_trained_features] è¿”å› common_features æ•°é‡: ...`

### æ–¹æ¡ˆäºŒï¼šéªŒè¯æ¨¡å‹æ–‡ä»¶æ˜¯å¦æ­£ç¡®éƒ¨ç½²

1. æ£€æŸ¥ Git ä»“åº“ä¸­æ˜¯å¦æœ‰ `trained_model.json`ï¼š
   ```bash
   git ls-files trained_model.json
   ```

2. æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆåº”è¯¥åœ¨ 17KB å·¦å³ï¼‰ï¼š
   ```bash
   ls -lh trained_model.json
   ```

3. éªŒè¯æ–‡ä»¶å†…å®¹ï¼š
   ```bash
   python3 -c "import json; data = json.load(open('trained_model.json')); print(f'ä¹°ç‚¹ç‰¹å¾: {len(data.get(\"buy_features\", {}).get(\"common_features\", {}))}'); print(f'å–ç‚¹ç‰¹å¾: {len(data.get(\"sell_features\", {}).get(\"common_features\", {}))}')"
   ```

### æ–¹æ¡ˆä¸‰ï¼šæ”¹è¿›é”™è¯¯å¤„ç†

å¦‚æœæ¨¡å‹æ–‡ä»¶åœ¨ Vercel ç¯å¢ƒä¸­æ— æ³•è¯»å–ï¼Œå¯ä»¥ï¼š

1. **ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ¨¡å‹æ•°æ®**ï¼ˆå¦‚æœæ¨¡å‹æ•°æ®ä¸å¤ªå¤§ï¼‰
2. **ä½¿ç”¨å¤–éƒ¨å­˜å‚¨æœåŠ¡**ï¼ˆå¦‚ Upstash Redisã€Vercel KVï¼‰å­˜å‚¨æ¨¡å‹
3. **æä¾›é»˜è®¤æ¨¡å‹**ï¼ˆç®€åŒ–ç‰ˆï¼Œç”¨äºæ¼”ç¤ºï¼‰

### æ–¹æ¡ˆå››ï¼šæ·»åŠ è¯¦ç»†æ—¥å¿—

æˆ‘å·²ç»æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼Œå¯ä»¥å¸®åŠ©è¯Šæ–­é—®é¢˜ï¼š

**å‰ç«¯æ—¥å¿—**ï¼š
```javascript
console.log('æ¨¡å‹æ£€æŸ¥ç»“æœ:', result);
console.log('æ¨¡å‹æ£€æŸ¥è¯¦æƒ…:', {
    success: result.success,
    hasCommonFeatures: !!result.common_features,
    commonFeaturesLength: result.common_features ? Object.keys(result.common_features).length : 0,
    commonFeaturesKeys: result.common_features ? Object.keys(result.common_features).slice(0, 5) : []
});
console.log('hasFeatures:', hasFeatures);
```

**åç«¯æ—¥å¿—**ï¼š
```python
print(f"[get_trained_features] trained æ˜¯å¦ä¸º None: {trained is None}")
print(f"[get_trained_features] common_features æ•°é‡: {len(result['common_features'])}")
```

## ğŸ“ éªŒè¯æ­¥éª¤

1. **æ£€æŸ¥ Vercel éƒ¨ç½²æ—¥å¿—**
   - æŸ¥çœ‹æ˜¯å¦æœ‰ "æ¨¡å‹åŠ è½½æˆåŠŸ" æˆ– "æœªæ‰¾åˆ°å·²ä¿å­˜çš„æ¨¡å‹" çš„æ—¥å¿—
   - æŸ¥çœ‹ `[get_trained_features]` ç›¸å…³çš„æ—¥å¿—

2. **æ£€æŸ¥å‰ç«¯æ§åˆ¶å°**
   - åˆ·æ–°é¡µé¢
   - æŸ¥çœ‹ `æ¨¡å‹æ£€æŸ¥ç»“æœ` å’Œ `æ¨¡å‹æ£€æŸ¥è¯¦æƒ…` çš„æ—¥å¿—
   - æŸ¥çœ‹ `hasFeatures` çš„å€¼

3. **æ‰‹åŠ¨æµ‹è¯• API**
   - åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š`https://ä½ çš„åŸŸå.vercel.app/api/get_trained_features`
   - æŸ¥çœ‹è¿”å›çš„ JSON æ•°æ®
   - æ£€æŸ¥ `success`ã€`common_features` å­—æ®µ

## ğŸ› ï¸ å¦‚æœæ¨¡å‹æ–‡ä»¶æ— æ³•è¯»å–

å¦‚æœç¡®è®¤ Vercel ç¯å¢ƒä¸­æ— æ³•è¯»å– `trained_model.json` æ–‡ä»¶ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹æ›¿ä»£æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆ Aï¼šä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆé€‚ç”¨äºå°å‹æ¨¡å‹ï¼‰

å°†æ¨¡å‹æ•°æ®ç¼–ç ä¸ºç¯å¢ƒå˜é‡ï¼ˆè™½ç„¶ä¸æ¨èï¼Œä½†å¯ä»¥ä½œä¸ºä¸´æ—¶æ–¹æ¡ˆï¼‰ã€‚

### æ–¹æ¡ˆ Bï¼šä½¿ç”¨å¤–éƒ¨å­˜å‚¨ï¼ˆæ¨èï¼‰

ä½¿ç”¨ Upstash Redis æˆ– Vercel KV å­˜å‚¨æ¨¡å‹æ•°æ®ï¼š

```python
# åœ¨åˆå§‹åŒ–æ—¶ä» Redis åŠ è½½æ¨¡å‹
if is_vercel:
    # å°è¯•ä» Redis åŠ è½½æ¨¡å‹
    model_data = redis_client.get('trained_model')
    if model_data:
        analyzer.load_model_from_dict(json.loads(model_data))
```

### æ–¹æ¡ˆ Cï¼šæä¾›ç®€åŒ–é»˜è®¤æ¨¡å‹

å¦‚æœæ²¡æœ‰æ¨¡å‹ï¼Œæä¾›ä¸€ä¸ªç®€åŒ–çš„é»˜è®¤æ¨¡å‹ï¼Œå…è®¸ç”¨æˆ·ç›´æ¥ä½¿ç”¨åŸºæœ¬åŠŸèƒ½ã€‚

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ï¼š
1. Vercel Function Logsï¼ˆç‰¹åˆ«æ˜¯ `[get_trained_features]` ç›¸å…³çš„æ—¥å¿—ï¼‰
2. æµè§ˆå™¨æ§åˆ¶å°å®Œæ•´æ—¥å¿—ï¼ˆåŒ…æ‹¬ `æ¨¡å‹æ£€æŸ¥è¯¦æƒ…`ï¼‰
3. API ç›´æ¥è®¿é—®ç»“æœï¼ˆ`/api/get_trained_features` çš„è¿”å›ï¼‰

---

**æ³¨æ„**ï¼šæˆ‘å·²ç»æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼Œä¸‹æ¬¡éƒ¨ç½²åï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—æ¥è¯Šæ–­é—®é¢˜ã€‚

