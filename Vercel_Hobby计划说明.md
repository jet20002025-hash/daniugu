# Vercel Hobby 计划说明

## 什么是 Hobby 计划？

**Hobby** 是 Vercel 的**免费计划**，适合个人开发者和小型项目。

### Hobby 计划的主要限制

1. **Cron Jobs（定时任务）限制**：
   - 每天只能运行 **1 次** cron job
   - 如果需要更频繁的定时任务，需要升级到 **Pro 计划**（$20/月）

2. **其他限制**：
   - 带宽：100GB/月
   - 函数执行时间：10秒（Serverless Functions）
   - 团队协作：有限

## 对我们项目的影响

### ❌ 受影响的功能（服务器端定时任务）

**股票列表缓存刷新**：
- 之前配置：交易时间段（9:30-11:30, 13:00-15:00）每5分钟刷新一次
- 现在配置：每天9:25（开盘前）刷新一次
- **原因**：Hobby 账户每天只能运行1次 cron job

### ✅ 不受影响的功能（用户端功能）

**VIP 用户的扫描功能**：
- ✅ **可以无限次手动扫描**（不受限制）
- ✅ **可以随时触发扫描**（点击"扫描全市场"按钮）
- ✅ **扫描功能完全正常**（不受 Hobby 计划限制）

## 为什么 VIP 用户扫描不受影响？

### 两个不同的概念：

1. **Vercel Cron Job（服务器端定时任务）**：
   - 用于：自动刷新股票列表缓存
   - 限制：Hobby 账户每天只能运行1次
   - 影响：缓存刷新频率降低（从每5分钟改为每天1次）

2. **VIP 用户扫描（用户端功能）**：
   - 用于：用户手动触发股票扫描
   - 方式：用户点击"扫描全市场"按钮
   - 限制：**无限制**（VIP 用户可以随时扫描）
   - 影响：**完全不受影响**

## 解决方案

### 方案 1：保持现状（推荐）

- 每天9:25自动刷新缓存（开盘前）
- VIP 用户可以随时手动扫描（不受限制）
- 如果缓存过期，用户扫描时会自动从 API 获取数据

### 方案 2：手动刷新缓存

如果需要更频繁的缓存刷新，可以：
- 访问：`https://www.daniugu.online/api/refresh_stock_cache?force=true`
- 在交易时间段内手动触发缓存刷新

### 方案 3：使用外部服务

使用第三方服务（如 GitHub Actions、UptimeRobot）定期调用缓存刷新 API：
- 可以设置每5分钟调用一次
- 绕过 Vercel 的 cron job 限制

### 方案 4：升级到 Pro 计划

- 费用：$20/月（约 ¥140/月）
- 优势：无限制 cron jobs，可以每5分钟运行一次

## 总结

✅ **VIP 用户的扫描功能完全不受影响**
- VIP 用户可以随时点击"扫描全市场"按钮
- 扫描次数无限制
- 功能完全正常

⚠️ **受影响的是缓存刷新频率**
- 从每5分钟改为每天1次（9:25）
- 不影响用户扫描功能
- 如果缓存过期，扫描时会自动从 API 获取数据


