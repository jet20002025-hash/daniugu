# 网络版推送说明

## 目标

确保推送到GitHub的代码**只包含网络版功能**，不包含本地版本的功能（如所有功能按钮、搜索反转个股等）。

## 当前代码结构

代码已经通过 `isLocalEnvironment()` 函数区分本地和网络环境：
- **本地环境**（localhost/127.0.0.1）：显示所有功能
- **网络环境**（其他域名）：根据用户等级显示功能

但问题是：**本地版本的HTML代码仍然存在于文件中**，只是通过JavaScript隐藏。

## 解决方案

### 方案1：创建网络版分支（推荐）

1. **创建 web-only 分支**（移除本地版本代码）：
   ```bash
   bash 创建网络版分支.sh
   ```
   这个脚本会：
   - 创建 `web-only` 分支
   - 移除本地版本的HTML代码
   - 简化JavaScript函数，移除本地版本逻辑

2. **合并到 main 分支**：
   ```bash
   bash 合并网络版到main.sh
   ```
   这个脚本会：
   - 切换到 main 分支
   - 合并 web-only 分支
   - 推送到GitHub（触发Vercel部署）

### 方案2：使用Python脚本移除代码

```bash
python3 移除本地版本代码.py
git add templates/bull_stock_web.html
git commit -m "移除本地版本代码，仅保留网络版功能"
git push origin main
```

## 分支策略

- **`local-dev-stock-search`**：包含所有代码（本地+网络），用于本地开发
- **`web-only`**：只包含网络版代码，用于推送到GitHub
- **`main`**：生产分支，只包含网络版代码，Vercel监听此分支

## 工作流程

### 本地开发
1. 在 `local-dev-stock-search` 分支开发
2. 测试本地版本功能
3. 测试网络版功能（通过修改hostname或使用网络环境）

### 推送到网络版
1. 创建 `web-only` 分支（移除本地版本代码）
2. 合并到 `main` 分支
3. 推送到GitHub
4. Vercel自动部署

## 注意事项

1. **不要直接推送 `local-dev-stock-search` 到 `main`**
   - 这会包含本地版本的代码

2. **定期同步**
   - 从 `local-dev-stock-search` 更新 `web-only` 分支
   - 确保网络版功能是最新的

3. **备份**
   - 脚本会自动创建备份文件
   - 如需恢复，使用 `.backup` 文件

## 快速推送网络版

```bash
# 一键操作
bash 创建网络版分支.sh
bash 合并网络版到main.sh
```

## 验证

推送后，在GitHub上检查：
- `main` 分支的 `templates/bull_stock_web.html` 不应该包含 `localVersionButtons`
- 不应该包含 `搜索反转个股` 相关代码
- `isLocalEnvironment()` 应该始终返回 `false`



