# 服务器自动重启说明

## ✅ 当前状态

服务器已配置为**自动重启模式**，修改代码后会自动重启服务器。

## 🔄 自动重启机制

### 监控的文件
以下文件被修改后，服务器会自动重启：

- `bull_stock_web.py` - Web服务器主文件
- `bull_stock_analyzer.py` - 股票分析核心逻辑
- `templates/bull_stock_web.html` - 前端HTML模板
- `data_fetcher.py` - 数据获取模块
- `technical_analysis.py` - 技术分析模块
- `trained_model.json` - 训练模型文件

### 工作原理

1. **自动监控脚本**：`auto_restart_server.py` 在后台运行
2. **文件监控**：每2秒检查一次监控文件的修改时间
3. **自动重启**：检测到文件变化后，自动停止旧服务器并启动新服务器
4. **日志记录**：服务器日志保存在 `bull_stock_web.log`

## 📝 使用方法

### 方法1：自动重启（推荐）

**无需任何操作**，直接修改代码并保存，服务器会在2秒内自动重启。

### 方法2：手动重启

如果需要手动重启服务器：

```bash
# 停止自动重启脚本（会同时停止服务器）
pkill -f auto_restart_server

# 重新启动自动重启脚本
cd /Users/zwj/股票分析
nohup python3 auto_restart_server.py > auto_restart.log 2>&1 &
```

### 方法3：查看服务器状态

```bash
# 查看服务器进程
ps aux | grep -E "python.*bull_stock|auto_restart" | grep -v grep

# 查看服务器日志
tail -f bull_stock_web.log

# 查看自动重启日志
tail -f auto_restart.log

# 检查端口是否被占用
lsof -ti:5002
```

## ⚠️ 注意事项

1. **修改代码后等待2秒**：自动重启有2秒的检查间隔，保存文件后稍等片刻即可
2. **浏览器刷新**：服务器重启后，浏览器可能需要刷新页面才能看到最新内容
3. **登录状态**：每次重启后需要重新登录（这是正常的安全机制）
4. **日志查看**：如果遇到问题，查看 `bull_stock_web.log` 获取详细错误信息

## 🔍 故障排查

### 服务器未启动

```bash
# 检查自动重启脚本是否运行
ps aux | grep auto_restart_server | grep -v grep

# 如果没有运行，手动启动
cd /Users/zwj/股票分析
nohup python3 auto_restart_server.py > auto_restart.log 2>&1 &
```

### 端口被占用

```bash
# 查看占用端口的进程
lsof -ti:5002

# 停止占用端口的进程
kill -9 $(lsof -ti:5002)

# 重新启动
nohup python3 auto_restart_server.py > auto_restart.log 2>&1 &
```

### 服务器无法访问

1. 检查服务器是否运行：`ps aux | grep bull_stock_web | grep -v grep`
2. 检查端口是否监听：`lsof -ti:5002`
3. 查看错误日志：`tail -50 bull_stock_web.log`

## 📊 当前服务器状态

- **服务器地址**：http://localhost:5002
- **自动重启**：✅ 已启用
- **监控间隔**：2秒
- **日志文件**：`bull_stock_web.log`

## 🎯 总结

**以后修改代码时，只需保存文件，服务器会自动重启，无需手动操作！**
